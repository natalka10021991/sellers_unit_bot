# WB Margin Bot üßÆ

Telegram –±–æ—Ç –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–∞—Ä–∂–∏ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ Wildberries.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìä –†–∞—Å—á–µ—Ç –º–∞—Ä–∂–∏ –∏ –Ω–∞—Ü–µ–Ω–∫–∏ —Ç–æ–≤–∞—Ä–∞
- üí∞ –£—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–∏ WB, –ª–æ–≥–∏—Å—Ç–∏–∫–∏ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è
- üéÅ 5 –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üí≥ –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–ø–∏—Å–∫–∏ (149‚ÇΩ/–º–µ—Å—è—Ü)
- üìà –ò—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—á–µ—Ç–æ–≤

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.local` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è –≤ Git):

```bash
cp env.example .env.local
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `.env.local`:

```env
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather
WB_API_TOKEN=–≤–∞—à_wb_—Ç–æ–∫–µ–Ω
NODE_ENV=development
API_PORT=3000
MINI_APP_URL=http://localhost:5173
```

### 3. –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
npm run dev
```

–ë–æ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è —Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞.

### 4. –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –ø—Ä–æ–¥–∞–∫—à–Ω

```bash
npm run build:prod
npm start
```

---

## üîÑ Dev –∏ Prod –æ–∫—Ä—É–∂–µ–Ω–∏—è

- **Development:** –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –≤–µ—Ç–∫–µ `develop`
- **Production:** –ü—Ä–æ–¥–∞–∫—à–µ–Ω –Ω–∞ –≤–µ—Ç–∫–µ `main` (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π)

üìñ **–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ:** –°–º–æ—Ç—Ä–∏ [DEVELOPMENT.md](./DEVELOPMENT.md)

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/start` | –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è |
| `/calculate` | –ù–∞—á–∞—Ç—å —Ä–∞—Å—á–µ—Ç –º–∞—Ä–∂–∏ |
| `/status` | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ |
| `/subscribe` | –û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É |
| `/cancel` | –û—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ä–∞—Å—á–µ—Ç |
| `/help` | –°–ø—Ä–∞–≤–∫–∞ |

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ bot.ts                    # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞
‚îú‚îÄ‚îÄ config.ts                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ types.ts                  # TypeScript —Ç–∏–ø—ã
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îî‚îÄ‚îÄ db.ts                 # SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ services/
    ‚îî‚îÄ‚îÄ margin-calculator.ts  # –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –º–∞—Ä–∂–∏
```

## –§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞ –º–∞—Ä–∂–∏

```
–ü—Ä–∏–±—ã–ª—å = –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ - –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å - (–¶–µ–Ω–∞ √ó –ö–æ–º–∏—Å—Å–∏—è%) - –õ–æ–≥–∏—Å—Ç–∏–∫–∞ - –•—Ä–∞–Ω–µ–Ω–∏–µ
–ú–∞—Ä–∂–∞ = (–ü—Ä–∏–±—ã–ª—å / –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏) √ó 100%
```

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Node.js** + **TypeScript**
- **grammY** - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Telegram –±–æ—Ç–æ–≤
- **better-sqlite3** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **dotenv** - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

## –î–µ–ø–ª–æ–π

### Railway (Production)

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫ –≤–µ—Ç–∫–µ `main`
2. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ `main`
3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Railway Dashboard:
   - `BOT_TOKEN`
   - `WB_API_TOKEN`
   - `MINI_APP_URL`
   - `NODE_ENV=production`

### Vercel (Mini App)

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫ –≤–µ—Ç–∫–µ `main`
2. Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ `main`
3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   - `VITE_API_URL` = URL –±–æ—Ç–∞ –Ω–∞ Railway

üìñ **–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** –°–º–æ—Ç—Ä–∏ [ARCHITECTURE.md](./ARCHITECTURE.md)

### VPS

```bash
git clone <repo>
cd telegram-bot
npm install
npm run build
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ PM2 –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ —Ñ–æ–Ω–µ
pm2 start dist/bot.js --name "wb-margin-bot"
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π

1. –û—Ç–∫—Ä–æ–π—Ç–µ @BotFather –≤ Telegram
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
3. –ù–∞–∂–º–∏—Ç–µ "Payments"
4. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (–ÆKassa, Stripe –∏ –¥—Ä.)
5. –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω –≤ `.env` –∫–∞–∫ `PAYMENT_PROVIDER_TOKEN`

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
