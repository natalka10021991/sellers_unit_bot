# Настройка WB API

## Шаг 1: Получение API токена

1. Зайди на https://dev.wildberries.ru/
2. Войди в личный кабинет
3. Перейди в раздел "API токены"
4. Создай новый токен для категории **"Контент"**
5. Скопируй токен

## Шаг 2: Добавление токена в .env

Добавь в файл `.env` в корне проекта:

```env
WB_API_TOKEN=твой_токен_здесь
```

**Важно:** Токен должен начинаться с префикса, который дает WB (обычно это длинная строка).

## Шаг 3: Проверка работы

После добавления токена:

1. Перезапусти бота
2. Проверь, что API сервер запустился на порту 3000
3. Открой в браузере: `http://localhost:3000/api/categories`
4. Должен вернуться JSON со списком категорий

## Endpoints API

После запуска бота доступны следующие endpoints:

- `GET /health` - проверка работоспособности
- `GET /api/categories` - список родительских категорий
- `GET /api/categories/:id/subjects` - предметы (подкатегории) для категории
- `GET /api/commission/:categoryId` - комиссия для категории

## Использование в Mini App

В Mini App API URL настраивается через переменную окружения:

```env
VITE_API_URL=http://localhost:3000
```

Или в коде (для продакшена):

```typescript
const API_URL = "https://your-bot-api-url.com";
```

## Лимиты WB API

Согласно документации:

- **100 запросов в минуту** для методов категории "Контент"
- Кэширование категорий на 1 час (они редко меняются)

## Troubleshooting

### Ошибка "WB API токен не установлен"

- Проверь, что токен добавлен в `.env`
- Проверь, что `.env` загружается правильно

### Ошибка 401 (Unauthorized)

- Проверь правильность токена
- Убедись, что токен для категории "Контент"

### Ошибка CORS в Mini App

- API должен быть доступен по HTTPS в продакшене
- Или используй прокси через бота (уже реализовано)
